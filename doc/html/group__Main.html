<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Exercicio 12 - Simulador de Rede de Petri: Funcoes primarias</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Exercicio 12 - Simulador de Rede de Petri
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">Este exercício tem como objetivo simular uma Rede de Petri, dado um arquivo de entrada</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Gerado por Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Busca');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&#160;Principal</span></a></li>
      <li><a href="modules.html"><span>Módulos</span></a></li>
      <li><a href="annotated.html"><span>Estruturas&#160;de&#160;Dados</span></a></li>
      <li><a href="files.html"><span>Arquivos</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Busca" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Todos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Estruturas de Dados</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Arquivos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funções</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variáveis</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Definições de Tipos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Definições e Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Grupos</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Funcoes primarias</div>  </div>
</div><!--header-->
<div class="contents">

<p>Grupo de funcoes que se encontram no programa principal, que executam as tarefas essenciais para o funcionamento do programa.  
<a href="#details">Mais...</a></p>
<table class="memberdecls">
<tr class="memitem:ga369407cd752b7e48268fc24f3a162839"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Main.html#ga369407cd752b7e48268fc24f3a162839">transicao</a> (void *arg)</td></tr>
<tr class="memdesc:ga369407cd752b7e48268fc24f3a162839"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funcao que executa a transicao da rede.  <a href="#ga369407cd752b7e48268fc24f3a162839">Mais...</a><br /></td></tr>
<tr class="separator:ga369407cd752b7e48268fc24f3a162839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73fc4450c799be5fbd99fdb0af67af4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Main.html#ga73fc4450c799be5fbd99fdb0af67af4a">desenha_rede</a> (<a class="el" href="listao_8h.html#a5f88faa1ee5af6b15f4afa2739f2e954">petri_t</a> *<a class="el" href="ex12_8c.html#aad43441acd0a9193f197c827a0309e50">rede</a>, const char *fname)</td></tr>
<tr class="memdesc:ga73fc4450c799be5fbd99fdb0af67af4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Desenha uma rede no Allegro e imprime num arquivo de imagem.  <a href="#ga73fc4450c799be5fbd99fdb0af67af4a">Mais...</a><br /></td></tr>
<tr class="separator:ga73fc4450c799be5fbd99fdb0af67af4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Descrição Detalhada</h2>
<p>Grupo de funcoes que se encontram no programa principal, que executam as tarefas essenciais para o funcionamento do programa. </p>
<h2 class="groupheader">Funções</h2>
<a class="anchor" id="ga73fc4450c799be5fbd99fdb0af67af4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void desenha_rede </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="listao_8h.html#a5f88faa1ee5af6b15f4afa2739f2e954">petri_t</a> *&#160;</td>
          <td class="paramname"><em>rede</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Desenha uma rede no Allegro e imprime num arquivo de imagem. </p>
<p>Esta funcao utiliza a biblioteca grafica Allegro para imprimir uma rede de Petri.</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rede</td><td>A variavel <em>rede</em> seria a rede de Petri.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fname</td><td>A variavel <em>fname</em> representa o nome do arquivo que sera gerado.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores Retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td>a funcao retorna nada. </td></tr>
  </table>
  </dd>
</dl>

<p>Definição na linha <a class="el" href="ex12_8c_source.html#l00456">456</a> do arquivo <a class="el" href="ex12_8c_source.html">ex12.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">float</span> ang,      <span class="comment">/* Angulacao antre cada elemento na imagem */</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          r_lugar,  <span class="comment">/* Raio da circunferencia que representa o lugar */</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          smaller,  <span class="comment">/* A menor das dimensoes da imagem */</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          <a class="code" href="structconta__trans__st.html#a4bd5af356cf0ea6cdaf27175d06d7d12">x</a>,        <span class="comment">/* Variavel geral para representar coordenada X */</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          y,        <span class="comment">/* Variavel geral para representar coordenada Y */</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          x1,       <span class="comment">/* Variavel geral para representar coordenada X */</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          y1,       <span class="comment">/* Variavel geral para representar coordenada Y */</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          x2,       <span class="comment">/* Variavel geral para representar coordenada X */</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          y2,       <span class="comment">/* Variavel geral para representar coordenada Y */</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          x3,       <span class="comment">/* Variavel geral para representar coordenada X */</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          y3,       <span class="comment">/* Variavel geral para representar coordenada Y */</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          co,       <span class="comment">/* Variavel geral para representar cosseno */</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          si;       <span class="comment">/* Variavel geral para representar seno */</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">unsigned</span> i, q;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="structlugar__st.html">lugar</a> *a_l = rede-&gt;<a class="code" href="structpetri__st.html#af33f73d8c092a54cad15b87453f8d75e">l</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    BITMAP *buff;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    PALETTE pal;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="structflecha__st.html">flecha</a> *a_tl = rede-&gt;<a class="code" href="structpetri__st.html#a856547f2832f74fcc7bd11b229b4dabd">tl</a>,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;           *a_lt = rede-&gt;<a class="code" href="structpetri__st.html#a0f32b70f9a86b58b0fadf2d9ca4dcdac">lt</a>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">/* Inicializacao Allegro */</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span>(install_allegro(SYSTEM_NONE, &amp;errno, atexit)!=0)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        exit(EXIT_FAILURE);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    set_color_depth(16);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    get_palette(pal);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    buff = create_bitmap(<a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>,<a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    smaller = (float)<a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span>(smaller &gt; (<span class="keywordtype">float</span>)<a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        smaller = (<span class="keywordtype">float</span>)<a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    r_lugar = smaller/4.0*(M_PI/(M_PI+(float)rede-&gt;<a class="code" href="structpetri__st.html#a7435770b899472b5d783871fc6ea1c3f">total_l</a>));</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span>(buff == NULL)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        printf(<span class="stringliteral">&quot;Could not create buffer!\n&quot;</span>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        exit(EXIT_FAILURE);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">/* Desenho propriamente dito */</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span>(rede-&gt;<a class="code" href="structpetri__st.html#a7435770b899472b5d783871fc6ea1c3f">total_l</a> &gt; rede-&gt;<a class="code" href="structpetri__st.html#a046c3eff311a245441d47fdf1405dbd6">total_t</a>)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        ang = M_PI/rede-&gt;<a class="code" href="structpetri__st.html#a7435770b899472b5d783871fc6ea1c3f">total_l</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        ang = M_PI/rede-&gt;<a class="code" href="structpetri__st.html#a046c3eff311a245441d47fdf1405dbd6">total_t</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;Desenhando %u lugares e %u transicoes espacados entre si %.2fº...\n&quot;</span>, rede-&gt;<a class="code" href="structpetri__st.html#a7435770b899472b5d783871fc6ea1c3f">total_l</a>, rede-&gt;<a class="code" href="structpetri__st.html#a046c3eff311a245441d47fdf1405dbd6">total_t</a>, ang*180.0/M_PI);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">/* Desenhando os lugares  */</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;rede-&gt;<a class="code" href="structpetri__st.html#a7435770b899472b5d783871fc6ea1c3f">total_l</a>;i++)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        a_l = <a class="code" href="group__Header.html#gaee2af46b4e7f9af51e4e93b412639c5a">buscarLugarPos</a>(rede-&gt;<a class="code" href="structpetri__st.html#af33f73d8c092a54cad15b87453f8d75e">l</a>, i);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        q = 0;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span>(a_l != NULL)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            q = a_l-&gt;<a class="code" href="structlugar__st.html#a0e2b4d5a8f5ab1526571847e9462a254">qtd</a>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        x = <a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 + (<a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 - r_lugar)*cos(2*i*ang);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        y = <a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 + (<a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 - r_lugar)*sin(2*i*ang);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        circle(buff, x, y, r_lugar, <a class="code" href="ex12_8c.html#a564a8a1173bd4fb63c4f3a1903143e6a">CORBRANCO</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        textprintf_ex(buff, font, x, y, <a class="code" href="ex12_8c.html#ad7dde6e35154225591228222edb21c1b">CORVERDE</a>, <a class="code" href="ex12_8c.html#aaa9af825d3a4f75b40c0403bd37c55bd">CORPRETO</a>, <span class="stringliteral">&quot;%u&quot;</span>, q);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;L%u(%u) (posicionada %.2fº)\n&quot;</span>, i, q, ang*(2*i)*180.0/M_PI);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        textprintf_ex(buff, font, x, y - r_lugar, <a class="code" href="ex12_8c.html#ad7dde6e35154225591228222edb21c1b">CORVERDE</a>, <a class="code" href="ex12_8c.html#aaa9af825d3a4f75b40c0403bd37c55bd">CORPRETO</a>, <span class="stringliteral">&quot;L%u&quot;</span>, i);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">/* Desenhando as transicoes  */</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;rede-&gt;<a class="code" href="structpetri__st.html#a046c3eff311a245441d47fdf1405dbd6">total_t</a>;i++)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        x = <a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 + (<a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 - r_lugar)*cos((2*i+1)*ang);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        y = <a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 + (<a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 - r_lugar)*sin((2*i+1)*ang);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        line(buff, x, y+r_lugar, x, y-r_lugar, <a class="code" href="ex12_8c.html#a564a8a1173bd4fb63c4f3a1903143e6a">CORBRANCO</a>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;T%u (posicionado %.2fº)\n&quot;</span>, i, ang*(2*i+1)*180.0/M_PI);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        textprintf_ex(buff, font, x, y - r_lugar, <a class="code" href="ex12_8c.html#ad7dde6e35154225591228222edb21c1b">CORVERDE</a>, <a class="code" href="ex12_8c.html#aaa9af825d3a4f75b40c0403bd37c55bd">CORPRETO</a>, <span class="stringliteral">&quot;T%u&quot;</span>, i);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">/* Desenhando as flechas */</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">while</span>(a_tl != NULL)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        i = a_tl-&gt;<a class="code" href="structflecha__st.html#a13b187a9cba943c6a87ec339b8c899ae">de</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        x1 = <a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 + (<a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 - r_lugar)*cos((2*i+1)*ang);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        y1 = <a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 + (<a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 - r_lugar)*sin((2*i+1)*ang);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        i = a_tl-&gt;<a class="code" href="structflecha__st.html#a5223790dbdf3eb9f52abc54d6e959833">para</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        x = <a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 + (<a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 - r_lugar)*cos(2*i*ang);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        y = <a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 + (<a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 - r_lugar)*sin(2*i*ang);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        co = <a class="code" href="group__Header.html#gadb4877932ec102678fc7b2e07b5ac653">lcos</a>(x1,y1,x,y);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        si = <a class="code" href="group__Header.html#ga648c3d8c98be97e55642a0a3adc9c82e">lsin</a>(x1,y1,x,y);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        x -= r_lugar*co;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        y -= r_lugar*si;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        line(buff, x1, y1, x, y, <a class="code" href="ex12_8c.html#a564a8a1173bd4fb63c4f3a1903143e6a">CORBRANCO</a>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        textprintf_ex(buff, font, (x+x1)/2, (y+y1)/2, <a class="code" href="ex12_8c.html#ad7dde6e35154225591228222edb21c1b">CORVERDE</a>, <a class="code" href="ex12_8c.html#aaa9af825d3a4f75b40c0403bd37c55bd">CORPRETO</a>, <span class="stringliteral">&quot;%u&quot;</span>, a_tl-&gt;<a class="code" href="structflecha__st.html#a9e39e32e3bfa9e8839668247873ef8f9">tk</a>);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        x2 = x - (r_lugar / 4) * (si + co);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        y2 = y + (r_lugar / 4) * (co - si);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        x3 = x + (r_lugar / 4) * (si - co);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        y3 = y - (r_lugar / 4) * (si + co);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        triangle(buff, x, y, x2, y2, x3, y3, <a class="code" href="ex12_8c.html#a564a8a1173bd4fb63c4f3a1903143e6a">CORBRANCO</a>);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        a_tl = a_tl-&gt;<a class="code" href="structflecha__st.html#abad38d52ef7177586f206eea56a7ed06">prox</a>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">while</span>(a_lt != NULL)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        i = a_lt-&gt;<a class="code" href="structflecha__st.html#a13b187a9cba943c6a87ec339b8c899ae">de</a>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        x1 = <a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 + (<a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 - r_lugar)*cos(2*i*ang);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        y1 = <a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 + (<a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 - r_lugar)*sin(2*i*ang);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        i = a_lt-&gt;para;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        x = <a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 + (<a class="code" href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a>/2.0 - r_lugar)*cos((2*i+1)*ang);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        y = <a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 + (<a class="code" href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a>/2.0 - r_lugar)*sin((2*i+1)*ang);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        co = <a class="code" href="group__Header.html#gadb4877932ec102678fc7b2e07b5ac653">lcos</a>(x1,y1,x,y);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        si = <a class="code" href="group__Header.html#ga648c3d8c98be97e55642a0a3adc9c82e">lsin</a>(x1,y1,x,y);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        x1 += r_lugar*co;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        y1 += r_lugar*si;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        line(buff, x1, y1, x, y, <a class="code" href="ex12_8c.html#a564a8a1173bd4fb63c4f3a1903143e6a">CORBRANCO</a>);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        textprintf_ex(buff, font, (x+x1)/2, (y+y1)/2, <a class="code" href="ex12_8c.html#ad7dde6e35154225591228222edb21c1b">CORVERDE</a>, <a class="code" href="ex12_8c.html#aaa9af825d3a4f75b40c0403bd37c55bd">CORPRETO</a>, <span class="stringliteral">&quot;%u&quot;</span>, a_lt-&gt;tk);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        x2 = x - (r_lugar / 4) * (si + co);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        y2 = y + (r_lugar / 4) * (co - si);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        x3 = x + (r_lugar / 4) * (si - co);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        y3 = y - (r_lugar / 4) * (si + co);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        triangle(buff, x, y, x2, y2, x3, y3, <a class="code" href="ex12_8c.html#a564a8a1173bd4fb63c4f3a1903143e6a">CORBRANCO</a>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        a_lt = a_lt-&gt;prox;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">/* Salvando Imagem */</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    save_bitmap(fname, buff, pal);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    destroy_bitmap(buff);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    allegro_exit();</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="ex12_8c.html#a06894677b320bfc02e448e1e62c6ddab">GIF</a>) printf(<span class="stringliteral">&quot;Imagem %s salva com sucesso!\n&quot;</span>, fname);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;}</div>
<div class="ttc" id="structpetri__st_html_a7435770b899472b5d783871fc6ea1c3f"><div class="ttname"><a href="structpetri__st.html#a7435770b899472b5d783871fc6ea1c3f">petri_st::total_l</a></div><div class="ttdeci">unsigned total_l</div><div class="ttdoc">Quantidade total de lugares. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00033">listao.h:33</a></div></div>
<div class="ttc" id="ex12_8c_html_af316c33cc298530f245e8b55330e86b5"><div class="ttname"><a href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a></div><div class="ttdeci">#define D</div><div class="ttdoc">Nivel de debug D. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00061">ex12.c:61</a></div></div>
<div class="ttc" id="structpetri__st_html_a856547f2832f74fcc7bd11b229b4dabd"><div class="ttname"><a href="structpetri__st.html#a856547f2832f74fcc7bd11b229b4dabd">petri_st::tl</a></div><div class="ttdeci">flecha * tl</div><div class="ttdoc">Lista de flechas Transicao -> Lugar. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00037">listao.h:37</a></div></div>
<div class="ttc" id="ex12_8c_html_a564a8a1173bd4fb63c4f3a1903143e6a"><div class="ttname"><a href="ex12_8c.html#a564a8a1173bd4fb63c4f3a1903143e6a">CORBRANCO</a></div><div class="ttdeci">#define CORBRANCO</div><div class="ttdoc">Macro para cor Allegro branca. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00090">ex12.c:90</a></div></div>
<div class="ttc" id="structlugar__st_html"><div class="ttname"><a href="structlugar__st.html">lugar_st</a></div><div class="ttdoc">Lista que descreve as caracteristicas dos Lugares. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00020">listao.h:20</a></div></div>
<div class="ttc" id="ex12_8c_html_a18cd8b0506fb45ee9381e245b7b79dc9"><div class="ttname"><a href="ex12_8c.html#a18cd8b0506fb45ee9381e245b7b79dc9">IMG_Y</a></div><div class="ttdeci">#define IMG_Y</div><div class="ttdoc">Tamanho Y da imagem gerada pelo Allegro. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00085">ex12.c:85</a></div></div>
<div class="ttc" id="ex12_8c_html_aaa9af825d3a4f75b40c0403bd37c55bd"><div class="ttname"><a href="ex12_8c.html#aaa9af825d3a4f75b40c0403bd37c55bd">CORPRETO</a></div><div class="ttdeci">#define CORPRETO</div><div class="ttdoc">Macro para cor Allegro preta. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00091">ex12.c:91</a></div></div>
<div class="ttc" id="ex12_8c_html_ad7dde6e35154225591228222edb21c1b"><div class="ttname"><a href="ex12_8c.html#ad7dde6e35154225591228222edb21c1b">CORVERDE</a></div><div class="ttdeci">#define CORVERDE</div><div class="ttdoc">Macro para cor Allegro verde. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00094">ex12.c:94</a></div></div>
<div class="ttc" id="structpetri__st_html_a046c3eff311a245441d47fdf1405dbd6"><div class="ttname"><a href="structpetri__st.html#a046c3eff311a245441d47fdf1405dbd6">petri_st::total_t</a></div><div class="ttdeci">unsigned total_t</div><div class="ttdoc">Quantidade total de transicoes. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00033">listao.h:33</a></div></div>
<div class="ttc" id="ex12_8c_html_a111da81ae5883147168bbb8366377b10"><div class="ttname"><a href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a></div><div class="ttdeci">#define B</div><div class="ttdoc">Nivel de debug B. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00059">ex12.c:59</a></div></div>
<div class="ttc" id="group__Header_html_gaee2af46b4e7f9af51e4e93b412639c5a"><div class="ttname"><a href="group__Header.html#gaee2af46b4e7f9af51e4e93b412639c5a">buscarLugarPos</a></div><div class="ttdeci">lugar * buscarLugarPos(lugar *cabeca, unsigned x)</div><div class="ttdoc">Busca na lista o lugar Lx. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8c_source.html#l00015">listao.c:15</a></div></div>
<div class="ttc" id="structlugar__st_html_a0e2b4d5a8f5ab1526571847e9462a254"><div class="ttname"><a href="structlugar__st.html#a0e2b4d5a8f5ab1526571847e9462a254">lugar_st::qtd</a></div><div class="ttdeci">unsigned qtd</div><div class="ttdoc">Quantidade de tokens no lugar. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00023">listao.h:23</a></div></div>
<div class="ttc" id="structconta__trans__st_html_a4bd5af356cf0ea6cdaf27175d06d7d12"><div class="ttname"><a href="structconta__trans__st.html#a4bd5af356cf0ea6cdaf27175d06d7d12">conta_trans_st::x</a></div><div class="ttdeci">unsigned x</div><div class="ttdoc">Contador de ativacoes. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00063">listao.h:63</a></div></div>
<div class="ttc" id="structflecha__st_html_a9e39e32e3bfa9e8839668247873ef8f9"><div class="ttname"><a href="structflecha__st.html#a9e39e32e3bfa9e8839668247873ef8f9">flecha_st::tk</a></div><div class="ttdeci">unsigned tk</div><div class="ttdoc">Quantidade de tokens necessaria para ativar a flecha. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00013">listao.h:13</a></div></div>
<div class="ttc" id="structflecha__st_html_a5223790dbdf3eb9f52abc54d6e959833"><div class="ttname"><a href="structflecha__st.html#a5223790dbdf3eb9f52abc54d6e959833">flecha_st::para</a></div><div class="ttdeci">unsigned para</div><div class="ttdoc">Ponto de chegada da flecha. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00012">listao.h:12</a></div></div>
<div class="ttc" id="group__Header_html_ga648c3d8c98be97e55642a0a3adc9c82e"><div class="ttname"><a href="group__Header.html#ga648c3d8c98be97e55642a0a3adc9c82e">lsin</a></div><div class="ttdeci">float lsin(float x1, float y1, float x2, float y2)</div><div class="ttdoc">Calcula o seno de um segmento de reta. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8c_source.html#l00394">listao.c:394</a></div></div>
<div class="ttc" id="structflecha__st_html_abad38d52ef7177586f206eea56a7ed06"><div class="ttname"><a href="structflecha__st.html#abad38d52ef7177586f206eea56a7ed06">flecha_st::prox</a></div><div class="ttdeci">struct flecha_st * prox</div><div class="ttdoc">Proximo elemento da lista de flechas. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00014">listao.h:14</a></div></div>
<div class="ttc" id="ex12_8c_html_a42a1818de9b7681ef0a4cf9451e05767"><div class="ttname"><a href="ex12_8c.html#a42a1818de9b7681ef0a4cf9451e05767">IMG_X</a></div><div class="ttdeci">#define IMG_X</div><div class="ttdoc">Tamanho X da imagem gerada pelo Allegro. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00081">ex12.c:81</a></div></div>
<div class="ttc" id="structflecha__st_html_a13b187a9cba943c6a87ec339b8c899ae"><div class="ttname"><a href="structflecha__st.html#a13b187a9cba943c6a87ec339b8c899ae">flecha_st::de</a></div><div class="ttdeci">unsigned de</div><div class="ttdoc">Ponto de partida da flecha. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00011">listao.h:11</a></div></div>
<div class="ttc" id="group__Header_html_gadb4877932ec102678fc7b2e07b5ac653"><div class="ttname"><a href="group__Header.html#gadb4877932ec102678fc7b2e07b5ac653">lcos</a></div><div class="ttdeci">float lcos(float x1, float y1, float x2, float y2)</div><div class="ttdoc">Calcula o cosseno de um segmento de reta. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8c_source.html#l00387">listao.c:387</a></div></div>
<div class="ttc" id="structpetri__st_html_a0f32b70f9a86b58b0fadf2d9ca4dcdac"><div class="ttname"><a href="structpetri__st.html#a0f32b70f9a86b58b0fadf2d9ca4dcdac">petri_st::lt</a></div><div class="ttdeci">flecha * lt</div><div class="ttdoc">Lista de flechas Lugar -> Transicao. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00036">listao.h:36</a></div></div>
<div class="ttc" id="ex12_8c_html_a06894677b320bfc02e448e1e62c6ddab"><div class="ttname"><a href="ex12_8c.html#a06894677b320bfc02e448e1e62c6ddab">GIF</a></div><div class="ttdeci">#define GIF</div><div class="ttdoc">Ativa modo GIF (Ainda nao implementado) </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00077">ex12.c:77</a></div></div>
<div class="ttc" id="ex12_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdoc">Ativa modo de debug. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00073">ex12.c:73</a></div></div>
<div class="ttc" id="structflecha__st_html"><div class="ttname"><a href="structflecha__st.html">flecha_st</a></div><div class="ttdoc">Lista que descreve as caracteristicas da Flecha. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00009">listao.h:9</a></div></div>
<div class="ttc" id="structpetri__st_html_af33f73d8c092a54cad15b87453f8d75e"><div class="ttname"><a href="structpetri__st.html#af33f73d8c092a54cad15b87453f8d75e">petri_st::l</a></div><div class="ttdeci">lugar * l</div><div class="ttdoc">Lista de lugares. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00035">listao.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga369407cd752b7e48268fc24f3a162839"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * transicao </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funcao que executa a transicao da rede. </p>
<p>Esta funcao deve checar as flechas de entrada, checar os lugares para ver se existe quantidade de tokens suficientes para disparar indicadas pelas flechas, checar as flechas de saida e depositar nos lugares a quantidade de token indicados pelas flechas</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>A variavel <em>arg</em> seria na realidade uma struct que recebeu um cast para ser passada atraves de uma pthread. Ela deve conter a rede de petri e o indice da transicao.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores Retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td>a funcao retorna nada. </td></tr>
  </table>
  </dd>
</dl>

<p>Definição na linha <a class="el" href="ex12_8c_source.html#l00296">296</a> do arquivo <a class="el" href="ex12_8c_source.html">ex12.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="structpassa__dados__st.html">dados</a> *n = (<a class="code" href="structpassa__dados__st.html">dados</a> *)(arg);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">unsigned</span> i = n-&gt;<a class="code" href="structpassa__dados__st.html#a5057d2ab77480a830502f7b82ad38992">pos</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">/* petri_t *r = n-&gt;net; */</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="structpetri__st.html">petri_t</a> *r = <a class="code" href="ex12_8c.html#aad43441acd0a9193f197c827a0309e50">rede</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span>(r == NULL)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        printf(<span class="stringliteral">&quot;ERRO: passando nada pra transicao!!\n&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="structflecha__st.html">flecha</a> *tlt = r -&gt; lt; <span class="comment">/* Cabeca da lista LugarTransicao */</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="structflecha__st.html">flecha</a> *ttl = r -&gt; tl; <span class="comment">/* Cabeca da lista TransicaoLugar */</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="structlugar__st.html">lugar</a> *tp = r -&gt; l; <span class="comment">/* Cabeca da lista Lugar */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="structflecha__st.html">flecha</a> *<a class="code" href="structconta__trans__st.html#a4bd5af356cf0ea6cdaf27175d06d7d12">x</a> = NULL; <span class="comment">/* Flecha atual */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="structlugar__st.html">lugar</a> *y = NULL; <span class="comment">/* Lugar atual */</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">unsigned</span> xde,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;             xtk,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;             xpara,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;             yqtd,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;             d,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;             dd,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;             c;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">/* Espera para todas as threads rodarem juntas */</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="ex12_8c.html#a9d7b490fa24d308a9c60bfaeabaafaa4">trigger</a>)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        ;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>==<a class="code" href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;[thread %u] Comecei\n&quot;</span>, i);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">/********************** Codigo reestruturado ****************/</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    c = 0; <span class="comment">/* Para saber se entrou pelo menos 1x no loop */</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    d = dd = 0; <span class="comment">/* Inicia os contadores de lugares existentes e lugares disponivels para tirar em 0 */</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    x = <a class="code" href="listao_8h.html#a44238f73c97e99e78bb48a3deacb03d6">buscarFlechaPara</a>(tlt, i); <span class="comment">/* Procura uma flecha &#39;lt&#39; que aponte para a transicao atual &#39;i&#39; */</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">/********************* CHECKS DA TRANSICAO **************************/</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">while</span>(x != NULL) <span class="comment">/* Enquanto houverem flechas */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        c = 1; <span class="comment">/* Marca que entrou no loop */</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        xtk = x -&gt; tk; <span class="comment">/* armazena a qtd de tokens que a flecha pede */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        xde = x -&gt; de; <span class="comment">/* armazena o lugar de origem dessa flecha */</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;[thread %u] Precisa remover %d tokens do lugar %d\n&quot;</span>, i, xtk, xde);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        y = <a class="code" href="group__Header.html#gaee2af46b4e7f9af51e4e93b412639c5a">buscarLugarPos</a>(tp, xde); <span class="comment">/* Procura o lugar em que a flecha parte */</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">if</span>(y != NULL) <span class="comment">/* Se o lugar de origem da flecha existir */</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            d++; <span class="comment">/* Marca que encontrou mais uma flecha */</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">if</span>((y-&gt;<a class="code" href="structlugar__st.html#a9d8c9892f5903f2a94e60718884baa98">isBusy</a> = (y-&gt;<a class="code" href="structlugar__st.html#a9d8c9892f5903f2a94e60718884baa98">isBusy</a>==<a class="code" href="ex12_8c.html#a4425d0e101bb499fafbb34111e9869fb">LIVRE</a> ? <a class="code" href="ex12_8c.html#abb10170b4e16362fbd158cb136e6274d">OCUPADO</a> : <a class="code" href="ex12_8c.html#a52a8efdf2cea302bff179102d93271ab">PROIBIDO</a>)) == <a class="code" href="ex12_8c.html#abb10170b4e16362fbd158cb136e6274d">OCUPADO</a>)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                yqtd = y -&gt; qtd; <span class="comment">/* Armazena a qntd de tokens desponivels no local */</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="keywordflow">if</span>(xtk &lt;= yqtd) <span class="comment">/* Se a qntd de tokens que a flecha pede for disponiveis no local */</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    dd++; <span class="comment">/* Marca que o local ta disponivel */</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;[thread %u] Lugar com tokens suficientes\n&quot;</span>, i);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;[thread %u] Lugar com tokens insuficientes\n&quot;</span>, i);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;[thread %u]Erro: lugar inexistente\n&quot;</span>, i);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        x = <a class="code" href="listao_8h.html#ab8236479d38d428287df73ed3ed6c7c8">buscarFlechaParaProx</a>(x, i); <span class="comment">/* Procura uma nova flecha */</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) &amp;&amp; !c) printf(<span class="stringliteral">&quot;[thread %u] Erro: transicao fantasma, nenhum lugar aponta para ela\n&quot;</span>, i); <span class="comment">/* Um else pro while */</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    c = 0; <span class="comment">/* Reseta a variavel de controle */</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">/**************************** ACOES DA TRANSICAO ***********************/</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span>(d == dd &amp;&amp; d &amp;&amp; dd) <span class="comment">/* Se a transicao estiver apta a disparar */</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;Transicao %u disparou\n&quot;</span>, i);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <a class="code" href="ex12_8c.html#a1a39641cc834e8d937c095ff99d9b0dc">it_escape</a> = 1;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        x = <a class="code" href="listao_8h.html#a44238f73c97e99e78bb48a3deacb03d6">buscarFlechaPara</a>(tlt, i); <span class="comment">/* Busca novamente as flechas que apontam para a transicao */</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <a class="code" href="group__Header.html#gac01181eca3e2a49b238339b8b3dcc6df">incrementaTrans</a>(&amp;<a class="code" href="ex12_8c.html#a8ef42b7518beda7205e045d76799ea3a">contador</a>, i);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">while</span>(x != NULL) <span class="comment">/* Repetindo a pesquisa de flechas */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            c = 1;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            xtk = x -&gt; tk;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            xde = x -&gt; de;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;     </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            y = <a class="code" href="group__Header.html#gaee2af46b4e7f9af51e4e93b412639c5a">buscarLugarPos</a>(tp, xde);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">if</span>(y != NULL)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                y -&gt; qtd = (y -&gt; qtd) - xtk; <span class="comment">/* Subtrai os tokens, condicao de corrida pode bugar essa parte deixando negativo */</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                y -&gt; isBusy = <a class="code" href="ex12_8c.html#a4425d0e101bb499fafbb34111e9869fb">LIVRE</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;[thread %u]Erro: lugar inexistente na 2 pesquisa\n&quot;</span>, i);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            x = <a class="code" href="listao_8h.html#ab8236479d38d428287df73ed3ed6c7c8">buscarFlechaParaProx</a>(x, i); <span class="comment">/* procura uma nova flecha */</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span>((<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) &amp;&amp; !c) printf(<span class="stringliteral">&quot;[thread %u] Erro: transicao fantasma, nenhum lugar aponta para ela 2 pesq\n&quot;</span>, i);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        c = 0; <span class="comment">/* Reseta a variavel de controle */</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment">/* Inicio da busca das flechas tl */</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        x = <a class="code" href="listao_8h.html#a7716eeb8f217006abda3bad5e6e4dfbb">buscarFlechaDe</a>(ttl, i); <span class="comment">/* Busca uma flecha que parta da transicao */</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">while</span>(x != NULL)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            c = 1;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            xtk = x -&gt; tk; <span class="comment">/* Armazena a qntd de tokens que deverao ser depositados indicados pela flecha */</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            xpara = x -&gt; para; <span class="comment">/* Armazena em que lugar deve depositar o token */</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            y = <a class="code" href="group__Header.html#gaee2af46b4e7f9af51e4e93b412639c5a">buscarLugarPos</a>(tp, xpara);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordflow">if</span>(y != NULL)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                y -&gt; qtd = (y -&gt; qtd) + xtk; <span class="comment">/* adiciona os tokens ao lugar de saida */</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;[thread %u] Erro: nao existe lugar de chegada da flecha\n&quot;</span>, i);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            x = <a class="code" href="listao_8h.html#a27a84e1b0d701fe5e8916eecf03cdb5d">buscarFlechaDeProx</a>(x, i); <span class="comment">/* Busca uma nova flecha */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">if</span>((<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) &amp;&amp; !c) printf(<span class="stringliteral">&quot;[thread %u] Erro: transicao fantasma, nenhum lugar e&#39; apontado por ela\n&quot;</span>, i);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">/* Desocupa os lugares */</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    x = <a class="code" href="listao_8h.html#a44238f73c97e99e78bb48a3deacb03d6">buscarFlechaPara</a>(tlt, i); <span class="comment">/* Busca novamente as flechas que apontam para a transicao */</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    c = 0;     </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">while</span>(x != NULL) <span class="comment">/* Repetindo a pesquisa de flechas */</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        c = 1;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        xde = x -&gt; de;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;     </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        y = <a class="code" href="group__Header.html#gaee2af46b4e7f9af51e4e93b412639c5a">buscarLugarPos</a>(tp, xde);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">if</span>(y != NULL)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            y -&gt; isBusy = <a class="code" href="ex12_8c.html#a4425d0e101bb499fafbb34111e9869fb">LIVRE</a>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) printf(<span class="stringliteral">&quot;[thread %u]Erro: lugar inexistente na 3 pesquisa\n&quot;</span>, i);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        x = <a class="code" href="listao_8h.html#ab8236479d38d428287df73ed3ed6c7c8">buscarFlechaParaProx</a>(x, i); <span class="comment">/* procura uma nova flecha */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> || <a class="code" href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a> == <a class="code" href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a>) &amp;&amp; !c) printf(<span class="stringliteral">&quot;[thread %u] Erro: transicao fantasma, nenhum lugar aponta para ela 3 pesq\n&quot;</span>, i);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div>
<div class="ttc" id="ex12_8c_html_a4425d0e101bb499fafbb34111e9869fb"><div class="ttname"><a href="ex12_8c.html#a4425d0e101bb499fafbb34111e9869fb">LIVRE</a></div><div class="ttdeci">#define LIVRE</div><div class="ttdoc">Estado do lugar em que ela pode executar uma transicao. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00063">ex12.c:63</a></div></div>
<div class="ttc" id="structpetri__st_html"><div class="ttname"><a href="structpetri__st.html">petri_st</a></div><div class="ttdoc">Descricao da rede de Petri sem as transicoes. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00031">listao.h:31</a></div></div>
<div class="ttc" id="ex12_8c_html_af316c33cc298530f245e8b55330e86b5"><div class="ttname"><a href="ex12_8c.html#af316c33cc298530f245e8b55330e86b5">D</a></div><div class="ttdeci">#define D</div><div class="ttdoc">Nivel de debug D. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00061">ex12.c:61</a></div></div>
<div class="ttc" id="structlugar__st_html_a9d8c9892f5903f2a94e60718884baa98"><div class="ttname"><a href="structlugar__st.html#a9d8c9892f5903f2a94e60718884baa98">lugar_st::isBusy</a></div><div class="ttdeci">int isBusy</div><div class="ttdoc">Flag se o lugar esta sendo modificado por uma transicao. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00024">listao.h:24</a></div></div>
<div class="ttc" id="structlugar__st_html"><div class="ttname"><a href="structlugar__st.html">lugar_st</a></div><div class="ttdoc">Lista que descreve as caracteristicas dos Lugares. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00020">listao.h:20</a></div></div>
<div class="ttc" id="ex12_8c_html_a9d7b490fa24d308a9c60bfaeabaafaa4"><div class="ttname"><a href="ex12_8c.html#a9d7b490fa24d308a9c60bfaeabaafaa4">trigger</a></div><div class="ttdeci">unsigned trigger</div><div class="ttdoc">Flag para todas as threads partirem "ao mesmo tempo". </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00102">ex12.c:102</a></div></div>
<div class="ttc" id="ex12_8c_html_a111da81ae5883147168bbb8366377b10"><div class="ttname"><a href="ex12_8c.html#a111da81ae5883147168bbb8366377b10">B</a></div><div class="ttdeci">#define B</div><div class="ttdoc">Nivel de debug B. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00059">ex12.c:59</a></div></div>
<div class="ttc" id="ex12_8c_html_a8ef42b7518beda7205e045d76799ea3a"><div class="ttname"><a href="ex12_8c.html#a8ef42b7518beda7205e045d76799ea3a">contador</a></div><div class="ttdeci">conta_trans * contador</div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00106">ex12.c:106</a></div></div>
<div class="ttc" id="ex12_8c_html_a1a39641cc834e8d937c095ff99d9b0dc"><div class="ttname"><a href="ex12_8c.html#a1a39641cc834e8d937c095ff99d9b0dc">it_escape</a></div><div class="ttdeci">unsigned it_escape</div><div class="ttdoc">Flag condicional da iteracao. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00101">ex12.c:101</a></div></div>
<div class="ttc" id="group__Header_html_gaee2af46b4e7f9af51e4e93b412639c5a"><div class="ttname"><a href="group__Header.html#gaee2af46b4e7f9af51e4e93b412639c5a">buscarLugarPos</a></div><div class="ttdeci">lugar * buscarLugarPos(lugar *cabeca, unsigned x)</div><div class="ttdoc">Busca na lista o lugar Lx. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8c_source.html#l00015">listao.c:15</a></div></div>
<div class="ttc" id="ex12_8c_html_ac4cf4b2ab929bd23951a8676eeac086b"><div class="ttname"><a href="ex12_8c.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a></div><div class="ttdeci">#define C</div><div class="ttdoc">Nivel de debug C. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00060">ex12.c:60</a></div></div>
<div class="ttc" id="ex12_8c_html_aad43441acd0a9193f197c827a0309e50"><div class="ttname"><a href="ex12_8c.html#aad43441acd0a9193f197c827a0309e50">rede</a></div><div class="ttdeci">petri_t * rede</div><div class="ttdoc">Rede de petri propriamente dita. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00104">ex12.c:104</a></div></div>
<div class="ttc" id="structconta__trans__st_html_a4bd5af356cf0ea6cdaf27175d06d7d12"><div class="ttname"><a href="structconta__trans__st.html#a4bd5af356cf0ea6cdaf27175d06d7d12">conta_trans_st::x</a></div><div class="ttdeci">unsigned x</div><div class="ttdoc">Contador de ativacoes. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00063">listao.h:63</a></div></div>
<div class="ttc" id="ex12_8c_html_a52a8efdf2cea302bff179102d93271ab"><div class="ttname"><a href="ex12_8c.html#a52a8efdf2cea302bff179102d93271ab">PROIBIDO</a></div><div class="ttdeci">#define PROIBIDO</div><div class="ttdoc">Estado do lugar em que uma transicao tenta ocupar um lugar ja ocupado. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00065">ex12.c:65</a></div></div>
<div class="ttc" id="structpassa__dados__st_html"><div class="ttname"><a href="structpassa__dados__st.html">passa_dados_st</a></div><div class="ttdoc">Lista de posicoes a serem passadas para a funcao transicao() </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00052">listao.h:52</a></div></div>
<div class="ttc" id="listao_8h_html_a44238f73c97e99e78bb48a3deacb03d6"><div class="ttname"><a href="listao_8h.html#a44238f73c97e99e78bb48a3deacb03d6">buscarFlechaPara</a></div><div class="ttdeci">flecha * buscarFlechaPara(flecha *cabeca, unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="listao_8c_source.html#l00153">listao.c:153</a></div></div>
<div class="ttc" id="ex12_8c_html_abb10170b4e16362fbd158cb136e6274d"><div class="ttname"><a href="ex12_8c.html#abb10170b4e16362fbd158cb136e6274d">OCUPADO</a></div><div class="ttdeci">#define OCUPADO</div><div class="ttdoc">Estado do lugar em que uma transicao esta ocorrendo. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00064">ex12.c:64</a></div></div>
<div class="ttc" id="listao_8h_html_a7716eeb8f217006abda3bad5e6e4dfbb"><div class="ttname"><a href="listao_8h.html#a7716eeb8f217006abda3bad5e6e4dfbb">buscarFlechaDe</a></div><div class="ttdeci">flecha * buscarFlechaDe(flecha *cabeca, unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="listao_8c_source.html#l00141">listao.c:141</a></div></div>
<div class="ttc" id="structpassa__dados__st_html_a5057d2ab77480a830502f7b82ad38992"><div class="ttname"><a href="structpassa__dados__st.html#a5057d2ab77480a830502f7b82ad38992">passa_dados_st::pos</a></div><div class="ttdeci">unsigned pos</div><div class="ttdoc">Endereco da transicao. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00054">listao.h:54</a></div></div>
<div class="ttc" id="listao_8h_html_a27a84e1b0d701fe5e8916eecf03cdb5d"><div class="ttname"><a href="listao_8h.html#a27a84e1b0d701fe5e8916eecf03cdb5d">buscarFlechaDeProx</a></div><div class="ttdeci">flecha * buscarFlechaDeProx(flecha *cabeca, unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="listao_8c_source.html#l00177">listao.c:177</a></div></div>
<div class="ttc" id="ex12_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="ex12_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdoc">Ativa modo de debug. </div><div class="ttdef"><b>Definition:</b> <a href="ex12_8c_source.html#l00073">ex12.c:73</a></div></div>
<div class="ttc" id="listao_8h_html_ab8236479d38d428287df73ed3ed6c7c8"><div class="ttname"><a href="listao_8h.html#ab8236479d38d428287df73ed3ed6c7c8">buscarFlechaParaProx</a></div><div class="ttdeci">flecha * buscarFlechaParaProx(flecha *cabeca, unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="listao_8c_source.html#l00191">listao.c:191</a></div></div>
<div class="ttc" id="structflecha__st_html"><div class="ttname"><a href="structflecha__st.html">flecha_st</a></div><div class="ttdoc">Lista que descreve as caracteristicas da Flecha. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8h_source.html#l00009">listao.h:9</a></div></div>
<div class="ttc" id="group__Header_html_gac01181eca3e2a49b238339b8b3dcc6df"><div class="ttname"><a href="group__Header.html#gac01181eca3e2a49b238339b8b3dcc6df">incrementaTrans</a></div><div class="ttdeci">void incrementaTrans(conta_trans **cabeca, unsigned pos)</div><div class="ttdoc">Incrementa 1 num contador inserido numa lista. </div><div class="ttdef"><b>Definition:</b> <a href="listao_8c_source.html#l00401">listao.c:401</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Gerado em Domingo, 20 de Dezembro de 2015 11:23:11 para Exercicio 12 - Simulador de Rede de Petri por &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
